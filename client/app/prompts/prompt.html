<div class="app-prompt" ng-app="promptController">
  <app-header></app-header>
  <div class="app-title">Prompt</div>
  <div class="app-prompt-challenge">
    {{ prompt.title }}
  </div>
  
  <!-- Show user's photo if they have submitted one for this prompt -->
  <!-- TODO: make css nicer; overlay "your submission" over the img -->
  <div ng-if="userPhotoSubmission">
    <img src="media/{{userPhotoSubmission.filename}}">
    <div>Your Submission</div>
  </div>

  <!-- show upload button IF allowed -->
  <div ng-if="userId != prompt.user.id && !userPhotoSubmission && submissionPeriodIsOpen">
    <form>
      <input type="submit" ng-file-select="onFileSelect($files)" class="app-prompt-upload" value="Upload"/>
    </form>
  </div>

  <div ng-if="userId == prompt.user.id">
    <p>Upload disabled: You're the author and can't participate!</p>
  </div>

  <div ng-if="userPhotoSubmission">
    <p>Upload disabled: You've already submitted a photo!</p>
  </div>
  

  <div class="app-prompt-box">Created by <span>{{ prompt.user.email }}</span></div>
  <div class="app-prompt-box">
      <span class='notice'>Prompt Closes</span>
      <span am-time-ago="prompt.endTime"></span>
    </div>
  <div class="app-prompt-box">
    <span class='notice'>Voting Ends</span>
    <span am-time-ago="prompt.votingEndTime"></span>
  </div>
  <!-- if there is a prompt.winner, display it here (photo and photo.userID) -->
  <div class="app-prompt-box">Winner: <span>{{ prompt.winner.user.email || 'No Winner'}}</span></div>
  <div class="app-prompt-box red">Photos!</div>
  <div ng-if="!prompt.photos.length"><br><center>no photos yet :(</center><br></div>
  <div class="app-prompt-gallery" ng-repeat="photo in prompt.photos">
    <a ui-sref="photo({ id: photo.id })"><img src="media/{{ photo.filename }}"/></a>
  </div>
</div>